

steps:
# api
- name: 'gcr.io/cloud-builders/docker'
  args: 
  - build
  - -t
  - gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-api:$SHORT_SHA
  - -f
  - Dockerfile.api
  - .
- name: 'gcr.io/cloud-builders/docker'
  args:
  - push
  - gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-api:$SHORT_SHA
# messenger
- name: 'gcr.io/cloud-builders/docker'
  args: 
  - build
  - -t
  - gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-messenger:$SHORT_SHA
  - -f
  - Dockerfile.messenger
  - .
- name: 'gcr.io/cloud-builders/docker'
  args:
  - push
  - gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-messenger:$SHORT_SHA
# stat
- name: 'gcr.io/cloud-builders/docker'
  args: 
  - build
  - -t
  - gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-stat:$SHORT_SHA
  - -f
  - Dockerfile.stat
  - .
- name: 'gcr.io/cloud-builders/docker'
  args:
  - push
  - gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-stat:$SHORT_SHA

images:
- gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-api:$SHORT_SHA
- gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-messenger:$SHORT_SHA
- gcr.io/$PROJECT_ID/$REPO_NAME/octopus-gateway-stat:$SHORT_SHA
